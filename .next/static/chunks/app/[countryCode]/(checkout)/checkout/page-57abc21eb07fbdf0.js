(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4125],{50825:function(e,s,i){Promise.resolve().then(i.bind(i,72673)),Promise.resolve().then(i.bind(i,86275)),Promise.resolve().then(i.bind(i,70073)),Promise.resolve().then(i.bind(i,46711)),Promise.resolve().then(i.bind(i,8981)),Promise.resolve().then(i.bind(i,95487)),Promise.resolve().then(i.bind(i,23383)),Promise.resolve().then(i.bind(i,75820)),Promise.resolve().then(i.bind(i,98936)),Promise.resolve().then(i.bind(i,1009)),Promise.resolve().then(i.bind(i,10911)),Promise.resolve().then(i.bind(i,75661)),Promise.resolve().then(i.bind(i,47302)),Promise.resolve().then(i.bind(i,51116)),Promise.resolve().then(i.bind(i,62898)),Promise.resolve().then(i.bind(i,94598)),Promise.resolve().then(i.bind(i,43022)),Promise.resolve().then(i.bind(i,68880)),Promise.resolve().then(i.bind(i,11962)),Promise.resolve().then(i.bind(i,65476)),Promise.resolve().then(i.bind(i,78469)),Promise.resolve().then(i.bind(i,49586)),Promise.resolve().then(i.bind(i,18855)),Promise.resolve().then(i.bind(i,85375)),Promise.resolve().then(i.bind(i,20868)),Promise.resolve().then(i.bind(i,18713)),Promise.resolve().then(i.bind(i,85414)),Promise.resolve().then(i.bind(i,79773)),Promise.resolve().then(i.bind(i,44936)),Promise.resolve().then(i.bind(i,65566)),Promise.resolve().then(i.bind(i,65161)),Promise.resolve().then(i.bind(i,95978)),Promise.resolve().then(i.bind(i,89409)),Promise.resolve().then(i.bind(i,23601)),Promise.resolve().then(i.bind(i,48421))},79773:function(e,s,i){"use strict";i.r(s);var a=i(57437),l=i(62637),d=i(97635),t=i(8218),n=i(10040);s.default=e=>{let{items:s,region:i}=e,r=s&&s.length>4;return(0,a.jsx)("div",{className:(0,l.L)({"pl-[1px] overflow-y-scroll overflow-x-hidden no-scrollbar max-h-[420px]":r}),children:(0,a.jsx)(d.i,{children:(0,a.jsx)(d.i.Body,{"data-testid":"items-table",children:s&&i?s.sort((e,s)=>e.created_at>s.created_at?-1:1).map(e=>(0,a.jsx)(t.default,{item:e,region:i,type:"preview"},e.id)):Array.from([,,,,,].keys()).map(e=>(0,a.jsx)(n.Z,{},e))})})})}},44936:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return A}});var a=i(57437),l=i(24033),d=i(76544),t=i(85414),n=i(59954),r=i(56235),o=i(17831),u=i(29034),c=i(2265),p=i(10315),m=i(10386),v=e=>{var s,i,l,d,t,n,r,o,u;let{cart:v,countryCode:h}=e,[g,x]=(0,c.useState)({"billing_address.first_name":(null==v?void 0:null===(s=v.billing_address)||void 0===s?void 0:s.first_name)||"","billing_address.last_name":(null==v?void 0:null===(i=v.billing_address)||void 0===i?void 0:i.last_name)||"","billing_address.address_1":(null==v?void 0:null===(l=v.billing_address)||void 0===l?void 0:l.address_1)||"","billing_address.company":(null==v?void 0:null===(d=v.billing_address)||void 0===d?void 0:d.company)||"","billing_address.postal_code":(null==v?void 0:null===(t=v.billing_address)||void 0===t?void 0:t.postal_code)||"","billing_address.city":(null==v?void 0:null===(n=v.billing_address)||void 0===n?void 0:n.city)||"","billing_address.country_code":(null==v?void 0:null===(r=v.billing_address)||void 0===r?void 0:r.country_code)||h||"","billing_address.province":(null==v?void 0:null===(o=v.billing_address)||void 0===o?void 0:o.province)||"","billing_address.phone":(null==v?void 0:null===(u=v.billing_address)||void 0===u?void 0:u.phone)||""});(0,c.useEffect)(()=>{var e,s,i,a,l,d,t,n,r;x({"billing_address.first_name":(null==v?void 0:null===(e=v.billing_address)||void 0===e?void 0:e.first_name)||"","billing_address.last_name":(null==v?void 0:null===(s=v.billing_address)||void 0===s?void 0:s.last_name)||"","billing_address.address_1":(null==v?void 0:null===(i=v.billing_address)||void 0===i?void 0:i.address_1)||"","billing_address.company":(null==v?void 0:null===(a=v.billing_address)||void 0===a?void 0:a.company)||"","billing_address.postal_code":(null==v?void 0:null===(l=v.billing_address)||void 0===l?void 0:l.postal_code)||"","billing_address.city":(null==v?void 0:null===(d=v.billing_address)||void 0===d?void 0:d.city)||"","billing_address.country_code":(null==v?void 0:null===(t=v.billing_address)||void 0===t?void 0:t.country_code)||"","billing_address.province":(null==v?void 0:null===(n=v.billing_address)||void 0===n?void 0:n.province)||"","billing_address.phone":(null==v?void 0:null===(r=v.billing_address)||void 0===r?void 0:r.phone)||""})},[null==v?void 0:v.billing_address]);let b=e=>{x({...g,[e.target.name]:e.target.value})};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(p.Z,{label:"First name",name:"billing_address.first_name",autoComplete:"given-name",value:g["billing_address.first_name"],onChange:b,required:!0,"data-testid":"billing-first-name-input"}),(0,a.jsx)(p.Z,{label:"Last name",name:"billing_address.last_name",autoComplete:"family-name",value:g["billing_address.last_name"],onChange:b,required:!0,"data-testid":"billing-last-name-input"}),(0,a.jsx)(p.Z,{label:"Address",name:"billing_address.address_1",autoComplete:"address-line1",value:g["billing_address.address_1"],onChange:b,required:!0,"data-testid":"billing-address-input"}),(0,a.jsx)(p.Z,{label:"Company",name:"billing_address.company",value:g["billing_address.company"],onChange:b,autoComplete:"organization","data-testid":"billing-company-input"}),(0,a.jsx)(p.Z,{label:"Postal code",name:"billing_address.postal_code",autoComplete:"postal-code",value:g["billing_address.postal_code"],onChange:b,required:!0,"data-testid":"billing-postal-input"}),(0,a.jsx)(p.Z,{label:"City",name:"billing_address.city",autoComplete:"address-level2",value:g["billing_address.city"],onChange:b,required:!0,"data-testid":"billing-city-input"}),(0,a.jsx)(m.Z,{name:"billing_address.country_code",autoComplete:"country",region:null==v?void 0:v.region,value:g["billing_address.country_code"],onChange:b,required:!0,"data-testid":"billing-country-select"}),(0,a.jsx)(p.Z,{label:"State / Province",name:"billing_address.province",autoComplete:"address-level1",value:g["billing_address.province"],onChange:b,"data-testid":"billing-province-input"}),(0,a.jsx)(p.Z,{label:"Phone",name:"billing_address.phone",autoComplete:"tel",value:g["billing_address.phone"],onChange:b,"data-testid":"billing-phone-input"})]})})},h=i(70073),g=i(51116),x=e=>{let{checked:s=!0,onChange:i,label:l,name:d,"data-testid":t}=e;return(0,a.jsxs)("div",{className:"flex items-center space-x-2 ",children:[(0,a.jsx)(h.Checkbox,{className:"text-base-regular flex items-center gap-x-2",id:"checkbox",role:"checkbox",type:"button",checked:s,"aria-checked":s,onClick:i,name:d,"data-testid":t}),(0,a.jsx)(g.Label,{htmlFor:"checkbox",className:"!transform-none !txt-medium",size:"large",children:l})]})},b=i(26887),_=i(16856),f=i(57044),j=i(62637),y=i(25727),N=i.n(y),w=i(83734),C=i(5161),P=i(42077),S=i.n(P);function Z(e,s){return S()(N()(e,["id","created_at","updated_at","deleted_at","metadata","customer_id"]),N()(s,["id","created_at","updated_at","deleted_at","metadata","customer_id"]))}var k=e=>{let{addresses:s,cart:i}=e,l=(0,c.useMemo)(()=>s.find(e=>Z(e,null==i?void 0:i.shipping_address)),[s,null==i?void 0:i.shipping_address]);return(0,a.jsx)(b.R,{onChange:e=>{let i=s.find(s=>s.id===e);i&&(0,C.uF)({shipping_address:N()(i,["id","created_at","updated_at","country","deleted_at","metadata","customer_id"])})},value:null==l?void 0:l.id,children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(b.R.Button,{className:"relative w-full flex justify-between items-center px-4 py-[10px] text-left bg-white cursor-default focus:outline-none border rounded-rounded focus-visible:ring-2 focus-visible:ring-opacity-75 focus-visible:ring-white focus-visible:ring-offset-gray-300 focus-visible:ring-offset-2 focus-visible:border-gray-300 text-base-regular","data-testid":"shipping-address-select",children:e=>{let{open:s}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"block truncate",children:l?l.address_1:"Choose an address"}),(0,a.jsx)(f.Z,{className:(0,j.L)("transition-rotate duration-200",{"transform rotate-180":s})})]})}}),(0,a.jsx)(_.u,{as:c.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)(b.R.Options,{className:"absolute z-20 w-full overflow-auto text-small-regular bg-white border border-top-0 max-h-60 focus:outline-none sm:text-sm","data-testid":"shipping-address-options",children:s.map(e=>{var s;return(0,a.jsx)(b.R.Option,{value:e.id,className:"cursor-default select-none relative pl-6 pr-10 hover:bg-gray-50 py-4","data-testid":"shipping-address-option",children:(0,a.jsxs)("div",{className:"flex gap-x-4 items-start",children:[(0,a.jsx)(w.Z,{checked:(null==l?void 0:l.id)===e.id,"data-testid":"shipping-address-radio"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("span",{className:"text-left text-base-semi",children:[e.first_name," ",e.last_name]}),e.company&&(0,a.jsx)("span",{className:"text-small-regular text-ui-fg-base",children:e.company}),(0,a.jsxs)("div",{className:"flex flex-col text-left text-base-regular mt-2",children:[(0,a.jsxs)("span",{children:[e.address_1,e.address_2&&(0,a.jsxs)("span",{children:[", ",e.address_2]})]}),(0,a.jsxs)("span",{children:[e.postal_code,", ",e.city]}),(0,a.jsxs)("span",{children:[e.province&&"".concat(e.province,", "),null===(s=e.country_code)||void 0===s?void 0:s.toUpperCase()]})]})]})]})},e.id)})})})]})})},E=i(34649),L=e=>{var s,i,l,d,t,n,r,o,u;let{customer:v,cart:h,checked:g,onChange:b,countryCode:_}=e,[f,j]=(0,c.useState)({"shipping_address.first_name":(null==h?void 0:null===(s=h.shipping_address)||void 0===s?void 0:s.first_name)||"","shipping_address.last_name":(null==h?void 0:null===(i=h.shipping_address)||void 0===i?void 0:i.last_name)||"","shipping_address.address_1":(null==h?void 0:null===(l=h.shipping_address)||void 0===l?void 0:l.address_1)||"","shipping_address.company":(null==h?void 0:null===(d=h.shipping_address)||void 0===d?void 0:d.company)||"","shipping_address.postal_code":(null==h?void 0:null===(t=h.shipping_address)||void 0===t?void 0:t.postal_code)||"","shipping_address.city":(null==h?void 0:null===(n=h.shipping_address)||void 0===n?void 0:n.city)||"","shipping_address.country_code":(null==h?void 0:null===(r=h.shipping_address)||void 0===r?void 0:r.country_code)||_||"","shipping_address.province":(null==h?void 0:null===(o=h.shipping_address)||void 0===o?void 0:o.province)||"",email:(null==h?void 0:h.email)||"","shipping_address.phone":(null==h?void 0:null===(u=h.shipping_address)||void 0===u?void 0:u.phone)||""}),y=(0,c.useMemo)(()=>null==h?void 0:h.region.countries.map(e=>e.iso_2),[null==h?void 0:h.region]),N=(0,c.useMemo)(()=>null==v?void 0:v.shipping_addresses.filter(e=>e.country_code&&(null==y?void 0:y.includes(e.country_code))),[null==v?void 0:v.shipping_addresses,y]);(0,c.useEffect)(()=>{var e,s,i,a,l,d,t,n,r;j({"shipping_address.first_name":(null==h?void 0:null===(e=h.shipping_address)||void 0===e?void 0:e.first_name)||"","shipping_address.last_name":(null==h?void 0:null===(s=h.shipping_address)||void 0===s?void 0:s.last_name)||"","shipping_address.address_1":(null==h?void 0:null===(i=h.shipping_address)||void 0===i?void 0:i.address_1)||"","shipping_address.company":(null==h?void 0:null===(a=h.shipping_address)||void 0===a?void 0:a.company)||"","shipping_address.postal_code":(null==h?void 0:null===(l=h.shipping_address)||void 0===l?void 0:l.postal_code)||"","shipping_address.city":(null==h?void 0:null===(d=h.shipping_address)||void 0===d?void 0:d.city)||"","shipping_address.country_code":(null==h?void 0:null===(t=h.shipping_address)||void 0===t?void 0:t.country_code)||"","shipping_address.province":(null==h?void 0:null===(n=h.shipping_address)||void 0===n?void 0:n.province)||"",email:(null==h?void 0:h.email)||"","shipping_address.phone":(null==h?void 0:null===(r=h.shipping_address)||void 0===r?void 0:r.phone)||""})},[null==h?void 0:h.shipping_address,null==h?void 0:h.email]);let w=e=>{j({...f,[e.target.name]:e.target.value})};return(0,a.jsxs)(a.Fragment,{children:[v&&((null==N?void 0:N.length)||0)>0&&(0,a.jsxs)(E.W,{className:"mb-6 flex flex-col gap-y-4 p-5",children:[(0,a.jsx)("p",{className:"text-small-regular",children:"Hi ".concat(v.first_name,", do you want to use one of your saved addresses?")}),(0,a.jsx)(k,{addresses:v.shipping_addresses,cart:h})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(p.Z,{label:"First name",name:"shipping_address.first_name",autoComplete:"given-name",value:f["shipping_address.first_name"],onChange:w,required:!0,"data-testid":"shipping-first-name-input"}),(0,a.jsx)(p.Z,{label:"Last name",name:"shipping_address.last_name",autoComplete:"family-name",value:f["shipping_address.last_name"],onChange:w,required:!0,"data-testid":"shipping-last-name-input"}),(0,a.jsx)(p.Z,{label:"Address",name:"shipping_address.address_1",autoComplete:"address-line1",value:f["shipping_address.address_1"],onChange:w,required:!0,"data-testid":"shipping-address-input"}),(0,a.jsx)(p.Z,{label:"Company",name:"shipping_address.company",value:f["shipping_address.company"],onChange:w,autoComplete:"organization","data-testid":"shipping-company-input"}),(0,a.jsx)(p.Z,{label:"Postal code",name:"shipping_address.postal_code",autoComplete:"postal-code",value:f["shipping_address.postal_code"],onChange:w,required:!0,"data-testid":"shipping-postal-code-input"}),(0,a.jsx)(p.Z,{label:"City",name:"shipping_address.city",autoComplete:"address-level2",value:f["shipping_address.city"],onChange:w,required:!0,"data-testid":"shipping-city-input"}),(0,a.jsx)(m.Z,{name:"shipping_address.country_code",autoComplete:"country",region:null==h?void 0:h.region,value:f["shipping_address.country_code"],onChange:w,required:!0,"data-testid":"shipping-country-select"}),(0,a.jsx)(p.Z,{label:"State / Province",name:"shipping_address.province",autoComplete:"address-level1",value:f["shipping_address.province"],onChange:w,"data-testid":"shipping-province-input"})]}),(0,a.jsx)("div",{className:"my-8",children:(0,a.jsx)(x,{label:"Billing address same as shipping address",name:"same_as_billing",checked:g,onChange:b,"data-testid":"billing-address-checkbox"})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsx)(p.Z,{label:"Email",name:"email",type:"email",title:"Enter a valid email address.",autoComplete:"email",value:f.email,onChange:w,required:!0,"data-testid":"shipping-email-input"}),(0,a.jsx)(p.Z,{label:"Phone",name:"shipping_address.phone",autoComplete:"tel",value:f["shipping_address.phone"],onChange:w,"data-testid":"shipping-phone-input"})]})]})},F=i(85605),R=i(54887),z=i(39895),A=e=>{var s,i;let{cart:c,customer:p}=e,m=(0,l.useSearchParams)(),h=(0,l.useRouter)(),g=(0,l.usePathname)(),x=(0,l.useParams)().countryCode,b="address"===m.get("step"),{state:_,toggle:f}=(0,t.useToggleState)(null==c||!c.shipping_address||null==c||!c.billing_address||Z(null==c?void 0:c.shipping_address,null==c?void 0:c.billing_address)),[j,y]=(0,R.useFormState)(C.ju,null);return(0,a.jsxs)("div",{className:"bg-white",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between mb-6",children:[(0,a.jsxs)(n.X,{level:"h2",className:"flex flex-row text-3xl-regular gap-x-2 items-baseline",children:["Shipping Address",!b&&(0,a.jsx)(d.Z,{})]}),!b&&(null==c?void 0:c.shipping_address)&&(0,a.jsx)(r.x,{children:(0,a.jsx)("button",{onClick:()=>{h.push(g+"?step=address")},className:"text-ui-fg-interactive hover:text-ui-fg-interactive-hover","data-testid":"edit-address-button",children:"Edit"})})]}),b?(0,a.jsx)("form",{action:y,children:(0,a.jsxs)("div",{className:"pb-8",children:[(0,a.jsx)(L,{customer:p,countryCode:x,checked:_,onChange:f,cart:c}),!_&&(0,a.jsxs)("div",{children:[(0,a.jsx)(n.X,{level:"h2",className:"text-3xl-regular gap-x-4 pb-6 pt-8",children:"Billing address"}),(0,a.jsx)(v,{cart:c,countryCode:x})]}),(0,a.jsx)(F.M,{className:"mt-6","data-testid":"submit-address-button",children:"Continue to delivery"}),(0,a.jsx)(z.Z,{error:j,"data-testid":"address-error-message"})]})}):(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"text-small-regular",children:c&&c.shipping_address?(0,a.jsx)("div",{className:"flex items-start gap-x-8",children:(0,a.jsxs)("div",{className:"flex items-start gap-x-1 w-full",children:[(0,a.jsxs)("div",{className:"flex flex-col w-1/3","data-testid":"shipping-address-summary",children:[(0,a.jsx)(r.x,{className:"txt-medium-plus text-ui-fg-base mb-1",children:"Shipping Address"}),(0,a.jsxs)(r.x,{className:"txt-medium text-ui-fg-subtle",children:[c.shipping_address.first_name," ",c.shipping_address.last_name]}),(0,a.jsxs)(r.x,{className:"txt-medium text-ui-fg-subtle",children:[c.shipping_address.address_1," ",c.shipping_address.address_2]}),(0,a.jsxs)(r.x,{className:"txt-medium text-ui-fg-subtle",children:[c.shipping_address.postal_code,","," ",c.shipping_address.city]}),(0,a.jsx)(r.x,{className:"txt-medium text-ui-fg-subtle",children:null===(s=c.shipping_address.country_code)||void 0===s?void 0:s.toUpperCase()})]}),(0,a.jsxs)("div",{className:"flex flex-col w-1/3 ","data-testid":"shipping-contact-summary",children:[(0,a.jsx)(r.x,{className:"txt-medium-plus text-ui-fg-base mb-1",children:"Contact"}),(0,a.jsx)(r.x,{className:"txt-medium text-ui-fg-subtle",children:c.shipping_address.phone}),(0,a.jsx)(r.x,{className:"txt-medium text-ui-fg-subtle",children:c.email})]}),(0,a.jsxs)("div",{className:"flex flex-col w-1/3","data-testid":"billing-address-summary",children:[(0,a.jsx)(r.x,{className:"txt-medium-plus text-ui-fg-base mb-1",children:"Billing Address"}),_?(0,a.jsx)(r.x,{className:"txt-medium text-ui-fg-subtle",children:"Billing- and delivery address are the same."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.x,{className:"txt-medium text-ui-fg-subtle",children:[c.billing_address.first_name," ",c.billing_address.last_name]}),(0,a.jsxs)(r.x,{className:"txt-medium text-ui-fg-subtle",children:[c.billing_address.address_1," ",c.billing_address.address_2]}),(0,a.jsxs)(r.x,{className:"txt-medium text-ui-fg-subtle",children:[c.billing_address.postal_code,","," ",c.billing_address.city]}),(0,a.jsx)(r.x,{className:"txt-medium text-ui-fg-subtle",children:null===(i=c.billing_address.country_code)||void 0===i?void 0:i.toUpperCase()})]})]})]})}):(0,a.jsx)("div",{children:(0,a.jsx)(u.Z,{})})})}),(0,a.jsx)(o.Z,{className:"mt-8"})]})}},10386:function(e,s,i){"use strict";var a=i(57437),l=i(2265),d=i(76825);let t=(0,l.forwardRef)((e,s)=>{let{placeholder:i="Country",region:t,defaultValue:n,...r}=e,o=(0,l.useRef)(null);(0,l.useImperativeHandle)(s,()=>o.current);let u=(0,l.useMemo)(()=>t?t.countries.map(e=>({value:e.iso_2,label:e.display_name})):[],[t]);return(0,a.jsx)(d.Z,{ref:o,placeholder:i,defaultValue:n,...r,children:u.map((e,s)=>{let{value:i,label:l}=e;return(0,a.jsx)("option",{value:i,children:l},s)})})});t.displayName="CountrySelect",s.Z=t},65161:function(e,s,i){"use strict";i.r(s),i.d(s,{StripeContext:function(){return u},default:function(){return v}});var a=i(57437),l=i(27106),d=i(2265),t=i(96974),n=e=>{var s,i;let{paymentSession:l,stripeKey:d,stripePromise:n,children:r}=e,o={clientSecret:null===(s=l.data)||void 0===s?void 0:s.client_secret};if(!d)throw Error("Stripe key is missing. Set NEXT_PUBLIC_STRIPE_KEY environment variable.");if(!n)throw Error("Stripe promise is missing. Make sure you have provided a valid Stripe key.");if(!(null==l?void 0:null===(i=l.data)||void 0===i?void 0:i.client_secret))throw Error("Stripe client secret is missing. Cannot initialize Stripe.");return(0,a.jsx)(t.Elements,{options:o,stripe:n,children:r})},r=i(62860),o=i(25566);let u=(0,d.createContext)(!1),c=o.env.NEXT_PUBLIC_STRIPE_KEY,p=c?(0,l.J)(c):null,m=o.env.NEXT_PUBLIC_PAYPAL_CLIENT_ID;var v=e=>{var s;let{cart:i,children:l}=e,d=i.payment_session;return(null==d?void 0:null===(s=d.provider_id)||void 0===s?void 0:s.includes("stripe"))&&d&&p?(0,a.jsx)(u.Provider,{value:!0,children:(0,a.jsx)(n,{paymentSession:d,stripeKey:c,stripePromise:p,children:l})}):(null==d?void 0:d.provider_id)==="paypal"&&void 0!==m&&i?(0,a.jsx)(r.Vv,{options:{"client-id":o.env.NEXT_PUBLIC_PAYPAL_CLIENT_ID||"test",currency:null==i?void 0:i.region.currency_code.toUpperCase(),intent:"authorize",components:"buttons"},children:l}):(0,a.jsx)("div",{children:l})}},95978:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return N}});var a=i(57437),l=i(2265),d=i(24033),t=i(75355),n=i(39895),r=i(76544),o=i(75746),u=i(59954),c=i(62637),p=i(56235),m=i(98340),v=i(34649),h=i(96974),g=i(17831),x=i(29034),b=i(83734),_=(i(35811),e=>{var s,i;let{paymentSession:l,selectedPaymentOptionId:d,paymentInfoMap:n,disabled:r=!1}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(t.E.Option,{value:l.provider_id,disabled:r,className:(0,c.L)("flex flex-col gap-y-2 text-small-regular cursor-pointer py-4 border rounded-rounded px-8 mb-2 hover:shadow-borders-interactive-with-active",{"border-ui-border-interactive":d===l.provider_id}),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between ",children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,a.jsx)(b.Z,{checked:d===l.provider_id}),(0,a.jsx)(p.x,{className:"text-base-regular",children:(null===(s=n[l.provider_id])||void 0===s?void 0:s.title)||l.provider_id}),!1,"manual"===l.provider_id&&!1]}),(0,a.jsx)("span",{className:"justify-self-end text-ui-fg-base",children:null===(i=n[l.provider_id])||void 0===i?void 0:i.icon})]}),"manual"===l.provider_id&&!1]},l.id)})}),f=i(5161),j=i(12164),y=i(65161),N=e=>{var s,i,b,N,w,C;let{cart:P}=e,[S,Z]=(0,l.useState)(!1),[k,E]=(0,l.useState)(null),[L,F]=(0,l.useState)(null),[R,z]=(0,l.useState)(!1),A=(0,d.useSearchParams)(),q=(0,d.useRouter)(),I=(0,d.usePathname)(),T="payment"===A.get("step"),B=(null==P?void 0:null===(s=P.payment_session)||void 0===s?void 0:s.provider_id)==="stripe",U=(0,l.useContext)(y.StripeContext),M=(null==P?void 0:P.gift_cards)&&(null==P?void 0:null===(i=P.gift_cards)||void 0===i?void 0:i.length)>0&&(null==P?void 0:P.total)===0,O=(null==P?void 0:P.payment_session)&&(null==P?void 0:P.shipping_methods.length)!==0||M,X=(0,l.useMemo)(()=>({style:{base:{fontFamily:"Inter, sans-serif",color:"#424270","::placeholder":{color:"rgb(107 114 128)"}}},classes:{base:"pt-3 pb-1 block w-full h-11 px-4 mt-0 bg-ui-bg-field border rounded-md appearance-none focus:outline-none focus:ring-0 focus:shadow-borders-interactive-with-active border-ui-border-base hover:bg-ui-bg-field-hover transition-all duration-300 ease-in-out"}}),[]),G=(0,l.useCallback)((e,s)=>{let i=new URLSearchParams(A);return i.set(e,s),i.toString()},[A]),D=async e=>{Z(!0),await (0,f.$P)(e).catch(e=>E(e.toString())).finally(()=>{"paypal"!==e&&Z(!1)})},Y=e=>{E(null),D(e)};return(0,l.useEffect)(()=>{Z(!1),E(null)},[T]),(0,a.jsxs)("div",{className:"bg-white",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between mb-6",children:[(0,a.jsxs)(u.X,{level:"h2",className:(0,c.L)("flex flex-row text-3xl-regular gap-x-2 items-baseline",{"opacity-50 pointer-events-none select-none":!T&&!O}),children:["Payment",!T&&O&&(0,a.jsx)(r.Z,{})]}),!T&&O&&(0,a.jsx)(p.x,{children:(0,a.jsx)("button",{onClick:()=>{q.push(I+"?"+G("step","payment"),{scroll:!1})},className:"text-ui-fg-interactive hover:text-ui-fg-interactive-hover","data-testid":"edit-payment-button",children:"Edit"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:T?"block":"hidden",children:[!M&&(null==P?void 0:null===(b=P.payment_sessions)||void 0===b?void 0:b.length)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.E,{value:(null===(N=P.payment_session)||void 0===N?void 0:N.provider_id)||"",onChange:e=>Y(e),children:P.payment_sessions.sort((e,s)=>e.provider_id>s.provider_id?1:-1).map(e=>{var s;return(0,a.jsx)(_,{paymentInfoMap:j.G,paymentSession:e,selectedPaymentOptionId:(null===(s=P.payment_session)||void 0===s?void 0:s.provider_id)||null},e.id)})}),B&&U&&(0,a.jsxs)("div",{className:"mt-5 transition-all duration-150 ease-in-out",children:[(0,a.jsx)(p.x,{className:"txt-medium-plus text-ui-fg-base mb-1",children:"Enter your card details:"}),(0,a.jsx)(h.CardElement,{options:X,onChange:e=>{var s;F(e.brand&&e.brand.charAt(0).toUpperCase()+e.brand.slice(1)),E((null===(s=e.error)||void 0===s?void 0:s.message)||null),z(e.complete)}})]})]}):M?(0,a.jsxs)("div",{className:"flex flex-col w-1/3",children:[(0,a.jsx)(p.x,{className:"txt-medium-plus text-ui-fg-base mb-1",children:"Payment method"}),(0,a.jsx)(p.x,{className:"txt-medium text-ui-fg-subtle","data-testid":"payment-method-summary",children:"Gift card"})]}):(0,a.jsx)("div",{className:"flex flex-col items-center justify-center px-4 py-16 text-ui-fg-base",children:(0,a.jsx)(x.Z,{})}),(0,a.jsx)(n.Z,{error:k,"data-testid":"payment-method-error-message"}),(0,a.jsx)(m.z,{size:"large",className:"mt-6",onClick:()=>{Z(!0),q.push(I+"?"+G("step","review"),{scroll:!1})},isLoading:S,disabled:B&&!R||!(null==P?void 0:P.payment_session)&&!M,"data-testid":"submit-payment-button",children:"Continue to review"})]}),(0,a.jsx)("div",{className:T?"hidden":"block",children:P&&O&&P.payment_session?(0,a.jsxs)("div",{className:"flex items-start gap-x-1 w-full",children:[(0,a.jsxs)("div",{className:"flex flex-col w-1/3",children:[(0,a.jsx)(p.x,{className:"txt-medium-plus text-ui-fg-base mb-1",children:"Payment method"}),(0,a.jsx)(p.x,{className:"txt-medium text-ui-fg-subtle","data-testid":"payment-method-summary",children:(null===(w=j.G[P.payment_session.provider_id])||void 0===w?void 0:w.title)||P.payment_session.provider_id}),!1]}),(0,a.jsxs)("div",{className:"flex flex-col w-1/3",children:[(0,a.jsx)(p.x,{className:"txt-medium-plus text-ui-fg-base mb-1",children:"Payment details"}),(0,a.jsxs)("div",{className:"flex gap-2 txt-medium text-ui-fg-subtle items-center","data-testid":"payment-details-summary",children:[(0,a.jsx)(v.W,{className:"flex items-center h-7 w-fit p-2 bg-ui-button-neutral-hover",children:(null===(C=j.G[P.payment_session.provider_id])||void 0===C?void 0:C.icon)||(0,a.jsx)(o.Z,{})}),(0,a.jsx)(p.x,{children:"stripe"===P.payment_session.provider_id&&L?L:"Another step will appear"})]})]})]}):M?(0,a.jsxs)("div",{className:"flex flex-col w-1/3",children:[(0,a.jsx)(p.x,{className:"txt-medium-plus text-ui-fg-base mb-1",children:"Payment method"}),(0,a.jsx)(p.x,{className:"txt-medium text-ui-fg-subtle","data-testid":"payment-method-summary",children:"Gift card"})]}):null})]}),(0,a.jsx)(g.Z,{className:"mt-8"})]})}},89409:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return f}});var a=i(57437),l=i(59954),d=i(62637),t=i(56235),n=i(98340),r=i(62860),o=i(96974),u=i(5161),c=i(2265),p=i(39895),m=i(29034);let v=()=>{let[e,s]=(0,c.useState)(!1),i=async()=>{s(!0),await (0,u.s1)()};return(0,a.jsx)(n.z,{onClick:i,isLoading:e,"data-testid":"submit-order-button",children:"Place order"})},h=e=>{let{cart:s,notReady:i,"data-testid":l}=e,[d,t]=(0,c.useState)(!1),[r,m]=(0,c.useState)(null),v=async()=>{await (0,u.s1)().catch(()=>{m("An error occurred, please try again."),t(!1)})},h=(0,o.useStripe)(),g=(0,o.useElements)(),x=null==g?void 0:g.getElement("card"),b=s.payment_session,_=async()=>{var e,i,a,l,d,n,r;if(t(!0),!h||!g||!x||!s){t(!1);return}await h.confirmCardPayment(b.data.client_secret,{payment_method:{card:x,billing_details:{name:s.billing_address.first_name+" "+s.billing_address.last_name,address:{city:null!==(e=s.billing_address.city)&&void 0!==e?e:void 0,country:null!==(i=s.billing_address.country_code)&&void 0!==i?i:void 0,line1:null!==(a=s.billing_address.address_1)&&void 0!==a?a:void 0,line2:null!==(l=s.billing_address.address_2)&&void 0!==l?l:void 0,postal_code:null!==(d=s.billing_address.postal_code)&&void 0!==d?d:void 0,state:null!==(n=s.billing_address.province)&&void 0!==n?n:void 0},email:s.email,phone:null!==(r=s.billing_address.phone)&&void 0!==r?r:void 0}}}).then(e=>{let{error:s,paymentIntent:i}=e;if(s){let e=s.payment_intent;(e&&"requires_capture"===e.status||e&&"succeeded"===e.status)&&v(),m(s.message||null);return}if(i&&"requires_capture"===i.status||"succeeded"===i.status)return v()})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.z,{disabled:!h||!g||i,onClick:_,size:"large",isLoading:d,"data-testid":l,children:"Place order"}),(0,a.jsx)(p.Z,{error:r,"data-testid":"stripe-payment-error-message"})]})},g=e=>{let{cart:s,notReady:i,"data-testid":l}=e,[d,t]=(0,c.useState)(!1),[n,o]=(0,c.useState)(null),v=async()=>{await (0,u.s1)().catch(()=>{o("An error occurred, please try again."),t(!1)})},h=s.payment_session,g=async(e,s)=>{var i;null==s||null===(i=s.order)||void 0===i||i.authorize().then(e=>{if("COMPLETED"!==e.status){o("An error occurred, status: ".concat(e.status));return}v()}).catch(()=>{o("An unknown error occurred, please try again."),t(!1)})},[{isPending:x,isResolved:b}]=(0,r.Up)();return x?(0,a.jsx)(m.Z,{}):b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.ch,{style:{layout:"horizontal"},createOrder:async()=>h.data.id,onApprove:g,disabled:i||d||x,"data-testid":l}),(0,a.jsx)(p.Z,{error:n,"data-testid":"paypal-payment-error-message"})]}):void 0},x=e=>{let{notReady:s}=e,[i,l]=(0,c.useState)(!1),[d,t]=(0,c.useState)(null),r=async()=>{await (0,u.s1)().catch(e=>{t(e.toString()),l(!1)})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.z,{disabled:s,isLoading:i,onClick:()=>{l(!0),r()},size:"large","data-testid":"submit-order-button",children:"Place order"}),(0,a.jsx)(p.Z,{error:d,"data-testid":"manual-payment-error-message"})]})};var b=e=>{var s;let{cart:i,"data-testid":l}=e,d=!i||!i.shipping_address||!i.billing_address||!i.email||i.shipping_methods.length<1;if((null==i?void 0:i.gift_cards)&&(null==i?void 0:null===(s=i.gift_cards)||void 0===s?void 0:s.length)>0&&(null==i?void 0:i.total)===0)return(0,a.jsx)(v,{});switch(i.payment_session.provider_id){case"stripe":return(0,a.jsx)(h,{notReady:d,cart:i,"data-testid":l});case"manual":return(0,a.jsx)(x,{notReady:d,"data-testid":l});case"paypal":return(0,a.jsx)(g,{notReady:d,cart:i,"data-testid":l});default:return(0,a.jsx)(n.z,{disabled:!0,children:"Select a payment method"})}},_=i(24033),f=e=>{var s;let{cart:i}=e,n="review"===(0,_.useSearchParams)().get("step"),r=(null==i?void 0:i.gift_cards)&&(null==i?void 0:null===(s=i.gift_cards)||void 0===s?void 0:s.length)>0&&(null==i?void 0:i.total)===0,o=i.shipping_address&&i.shipping_methods.length>0&&(i.payment_session||r);return(0,a.jsxs)("div",{className:"bg-white",children:[(0,a.jsx)("div",{className:"flex flex-row items-center justify-between mb-6",children:(0,a.jsx)(l.X,{level:"h2",className:(0,d.L)("flex flex-row text-3xl-regular gap-x-2 items-baseline",{"opacity-50 pointer-events-none select-none":!n}),children:"Review"})}),n&&o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex items-start gap-x-1 w-full mb-6",children:(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(t.x,{className:"txt-medium-plus text-ui-fg-base mb-1",children:"By clicking the Place Order button, you confirm that you have read, understand and accept our Terms of Use, Terms of Sale and Returns Policy and acknowledge that you have read Medusa Store's Privacy Policy."})})}),(0,a.jsx)(b,{cart:i,"data-testid":"submit-order-button"})]})]})}},23601:function(e,s,i){"use strict";i.r(s);var a=i(57437),l=i(75355),d=i(76544),t=i(59954),n=i(62637),r=i(56235),o=i(98340),u=i(46128),c=i(17831),p=i(83734),m=i(29034),v=i(39895),h=i(5161),g=i(24033),x=i(2265);s.default=e=>{var s;let{cart:i,availableShippingMethods:b}=e,[_,f]=(0,x.useState)(!1),[j,y]=(0,x.useState)(null),N=(0,g.useSearchParams)(),w=(0,g.useRouter)(),C=(0,g.usePathname)(),P="delivery"===N.get("step"),S=async e=>{f(!0),await (0,h.qb)(e).then(()=>{f(!1)}).catch(e=>{y(e.toString()),f(!1)})},Z=e=>{S(e)};return(0,x.useEffect)(()=>{f(!1),y(null)},[P]),(0,a.jsxs)("div",{className:"bg-white",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between mb-6",children:[(0,a.jsxs)(t.X,{level:"h2",className:(0,n.L)("flex flex-row text-3xl-regular gap-x-2 items-baseline",{"opacity-50 pointer-events-none select-none":!P&&0===i.shipping_methods.length}),children:["Delivery",!P&&i.shipping_methods.length>0&&(0,a.jsx)(d.Z,{})]}),!P&&(null==i?void 0:i.shipping_address)&&(null==i?void 0:i.billing_address)&&(null==i?void 0:i.email)&&(0,a.jsx)(r.x,{children:(0,a.jsx)("button",{onClick:()=>{w.push(C+"?step=delivery",{scroll:!1})},className:"text-ui-fg-interactive hover:text-ui-fg-interactive-hover","data-testid":"edit-delivery-button",children:"Edit"})})]}),P?(0,a.jsxs)("div",{"data-testid":"delivery-options-container",children:[(0,a.jsx)("div",{className:"pb-8",children:(0,a.jsx)(l.E,{value:null===(s=i.shipping_methods[0])||void 0===s?void 0:s.shipping_option_id,onChange:e=>Z(e),children:b?b.map(e=>{var s,d;return(0,a.jsxs)(l.E.Option,{value:e.id,"data-testid":"delivery-option-radio",className:(0,n.L)("flex items-center justify-between text-small-regular cursor-pointer py-4 border rounded-rounded px-8 mb-2 hover:shadow-borders-interactive-with-active",{"border-ui-border-interactive":e.id===(null===(s=i.shipping_methods[0])||void 0===s?void 0:s.shipping_option_id)}),children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,a.jsx)(p.Z,{checked:e.id===(null===(d=i.shipping_methods[0])||void 0===d?void 0:d.shipping_option_id)}),(0,a.jsx)("span",{className:"text-base-regular",children:e.name})]}),(0,a.jsx)("span",{className:"justify-self-end text-ui-fg-base",children:(0,u.dN)({amount:e.amount,region:null==i?void 0:i.region,includeTaxes:!1})})]},e.id)}):(0,a.jsx)("div",{className:"flex flex-col items-center justify-center px-4 py-8 text-ui-fg-base",children:(0,a.jsx)(m.Z,{})})})}),(0,a.jsx)(v.Z,{error:j,"data-testid":"delivery-option-error-message"}),(0,a.jsx)(o.z,{size:"large",className:"mt-6",onClick:()=>{f(!0),w.push(C+"?step=payment",{scroll:!1})},isLoading:_,disabled:!i.shipping_methods[0],"data-testid":"submit-delivery-option-button",children:"Continue to payment"})]}):(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"text-small-regular",children:i&&i.shipping_methods.length>0&&(0,a.jsxs)("div",{className:"flex flex-col w-1/3",children:[(0,a.jsx)(r.x,{className:"txt-medium-plus text-ui-fg-base mb-1",children:"Method"}),(0,a.jsxs)(r.x,{className:"txt-medium text-ui-fg-subtle",children:[i.shipping_methods[0].shipping_option.name," (",(0,u.dN)({amount:i.shipping_methods[0].price,region:i.region,includeTaxes:!1}).replace(/,/g,"").replace(/\./g,","),")"]})]})})}),(0,a.jsx)(c.Z,{className:"mt-8"})]})}},76825:function(e,s,i){"use strict";var a=i(57437),l=i(57044),d=i(62637),t=i(2265);let n=(0,t.forwardRef)((e,s)=>{var i;let{placeholder:n="Select...",defaultValue:r,className:o,children:u,...c}=e,p=(0,t.useRef)(null),[m,v]=(0,t.useState)(!1);return(0,t.useImperativeHandle)(s,()=>p.current),(0,t.useEffect)(()=>{p.current&&""===p.current.value?v(!0):v(!1)},[null===(i=p.current)||void 0===i?void 0:i.value]),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{onFocus:()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.focus()},onBlur:()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.blur()},className:(0,d.L)("relative flex items-center text-base-regular border border-ui-border-base bg-ui-bg-subtle rounded-md hover:bg-ui-bg-field-hover",o,{"text-ui-fg-muted":m}),children:[(0,a.jsxs)("select",{ref:p,defaultValue:r,...c,className:"appearance-none flex-1 bg-transparent border-none px-4 py-2.5 transition-colors duration-150 outline-none ",children:[(0,a.jsx)("option",{disabled:!0,value:"",children:n}),u]}),(0,a.jsx)("span",{className:"absolute right-4 inset-y-0 flex items-center pointer-events-none ",children:(0,a.jsx)(l.Z,{})})]})})});n.displayName="NativeSelect",s.Z=n},83734:function(e,s,i){"use strict";var a=i(57437);s.Z=e=>{let{checked:s,"data-testid":i}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("button",{type:"button",role:"radio","aria-checked":"true","data-state":s?"checked":"unchecked",className:"group relative flex h-5 w-5 items-center justify-center outline-none","data-testid":i||"radio-button",children:(0,a.jsx)("div",{className:"shadow-borders-base group-hover:shadow-borders-strong-with-shadow bg-ui-bg-base group-data-[state=checked]:bg-ui-bg-interactive group-data-[state=checked]:shadow-borders-interactive group-focus:!shadow-borders-interactive-with-focus group-disabled:!bg-ui-bg-disabled group-disabled:!shadow-borders-base flex h-[14px] w-[14px] items-center justify-center rounded-full transition-all",children:s&&(0,a.jsx)("span",{"data-state":s?"checked":"unchecked",className:"group flex items-center justify-center",children:(0,a.jsx)("div",{className:"bg-ui-bg-base shadow-details-contrast-on-bg-interactive group-disabled:bg-ui-fg-disabled rounded-full group-disabled:shadow-none h-1.5 w-1.5"})})})})})}},10040:function(e,s,i){"use strict";var a=i(57437),l=i(97635);s.Z=()=>(0,a.jsxs)(l.i.Row,{className:"w-full m-4",children:[(0,a.jsx)(l.i.Cell,{className:"p-4 w-24",children:(0,a.jsx)("div",{className:"flex w-24 h-24 p-4 bg-gray-200 animate-pulse"})}),(0,a.jsx)(l.i.Cell,{className:"text-left",children:(0,a.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,a.jsx)("div",{className:"w-32 h-4 bg-gray-200 animate-pulse"}),(0,a.jsx)("div",{className:"w-24 h-4 bg-gray-200 animate-pulse"})]})}),(0,a.jsx)(l.i.Cell,{children:(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)("div",{className:"w-6 h-8 bg-gray-200 animate-pulse"}),(0,a.jsx)("div",{className:"w-14 h-10 bg-gray-200 animate-pulse"})]})}),(0,a.jsx)(l.i.Cell,{children:(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)("div",{className:"w-12 h-6 bg-gray-200 animate-pulse"})})}),(0,a.jsx)(l.i.Cell,{children:(0,a.jsx)("div",{className:"flex gap-2 justify-end",children:(0,a.jsx)("div",{className:"w-12 h-6 bg-gray-200 animate-pulse"})})})]})}},function(e){e.O(0,[8982,5250,1115,6191,377,971,8001,4576,7188,3824,2971,4938,1744],function(){return e(e.s=50825)}),_N_E=e.O()}]);